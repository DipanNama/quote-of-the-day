<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Quote of the Day</title>

    <!-- TailwindCSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Fonts & Icons -->
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/remixicon@4.5.0/fonts/remixicon.css"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="style.css" />
  </head>

  <body>
    <div class="wrapper flex justify-center items-center min-h-screen p-4">
      <div class="card w-full max-w-sm sm:max-w-md">
        <div class="card-content flex flex-col space-y-6">

          <!-- Top Bar -->
          <div class="flex justify-between items-center">
            <div class="flex space-x-2">
              <div class="h-3 w-3 rounded-full bg-red-500"></div>
              <div class="h-3 w-3 rounded-full bg-yellow-500"></div>
              <div class="h-3 w-3 rounded-full bg-green-500"></div>
            </div>
            <button id="themeToggle" aria-label="Toggle Theme" class="text-xl">
              <i class="ri-moon-line"></i>
            </button>
          </div>

          <!-- Quote Section -->
          <main class="text-center px-2">
            <sup><i class="ri-double-quotes-l text-2xl text-pink-400"></i></sup>
            <blockquote
              id="data"
              class="px-2 text-base sm:text-lg leading-relaxed font-medium fade-in"
            >
              LISP has assisted a number of our most gifted fellow humans in
              thinking previously impossible thoughts.
            </blockquote>
            <sub><i class="ri-double-quotes-r text-2xl text-pink-400"></i></sub>
          </main>

          <!-- Author -->
          <cite
            id="author"
            class="block text-right text-sm sm:text-base font-semibold italic text-gray-300"
          >
            â€” Edsger W. Dijkstra
          </cite>

          <hr />

          <!-- Buttons -->
          <div class="flex flex-col sm:flex-row gap-3 pt-2">
            <button
              id="prevBtn"
              aria-label="Previous Quote"
              class="hidden bg-red-500 hover:bg-red-600 w-full sm:w-auto px-5 py-2.5 rounded-full font-semibold shadow-md text-white transition-all"
            >
              Previous
            </button>
            <button
              id="btn"
              aria-label="Get New Quote"
              class="bg-blue-500 hover:bg-blue-600 w-full sm:w-auto px-5 py-2.5 rounded-full font-semibold shadow-md text-white transition-all"
            >
              New Quote
            </button>
          </div>

          <!-- Loading Spinner -->
          <div id="loading" class="hidden flex justify-center pt-2">
            <i class="ri-loader-4-line animate-spin text-2xl text-pink-400"></i>
          </div>
        </div>
      </div>
    </div>

      } catch (err) {
        // This runs if ALL APIs fail or time out
        console.error("All APIs failed. Using a fallback quote.", err);
        const fallbackQuote = getRandomFallbackQuote();
        if (currentQuote) history.push(currentQuote);
        currentQuote = fallbackQuote;
        updateUI(fallbackQuote);
      } finally {
        // This always runs, ensuring the UI is reset correctly
        if (history.length > 0) prevBtn.classList.remove("hidden");
        btn.textContent = "New Quote";
        btn.disabled = false;
      }
    }

    themeToggle.addEventListener("click", () => {
      document.body.classList.toggle("light-theme");

      const icon = themeToggle.querySelector("i");
      const isLight = document.body.classList.contains("light-theme");

      icon.className = isLight ? "ri-sun-line" : "ri-moon-line";
    });
    </script>
</html>
